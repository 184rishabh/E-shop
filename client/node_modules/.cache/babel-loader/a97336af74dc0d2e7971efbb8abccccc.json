{"ast":null,"code":"import _defineProperty from\"/Users/rishabh/Desktop/E-shop/e-shop/client/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _regeneratorRuntime from\"/Users/rishabh/Desktop/E-shop/e-shop/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/rishabh/Desktop/E-shop/e-shop/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/rishabh/Desktop/E-shop/e-shop/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React from'react';import{Fragment}from'react';import'./dashboard.css';import NAV from'../components/nav';import{isauthenticated}from'../auth/authenticate';import{useState}from'react';import{Redirect}from'react-router-dom';import axios from'axios';import{useEffect}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function DASHBOARD(){var _jsx2;var user=isauthenticated().user;var token=isauthenticated().token;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),deletesucess=_useState2[0],setdeletesucess=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),addsuccess=_useState4[0],setaddsuccess=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),passsuccess=_useState6[0],setpasssuccess=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),orderdata=_useState8[0],setorderdata=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),error=_useState10[0],seterror=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),len=_useState12[0],setlen=_useState12[1];var _useState13=useState(\"\"),_useState14=_slicedToArray(_useState13,2),add=_useState14[0],setadd=_useState14[1];var _useState15=useState(\"\"),_useState16=_slicedToArray(_useState15,2),newpass=_useState16[0],setnewpass=_useState16[1];var id=user._id;var usertoken=token;useEffect(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var order;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(\"http://localhost:5000/api/order/find/\".concat(id),{method:\"GET\",headers:{Accept:'application/json',\"content-type\":\"application/json\",token:\"Bearer \".concat(usertoken)}}).then(function(response){return response.json();}).catch(function(err){console.log(err);});case 2:order=_context.sent;setorderdata(order);case 4:case\"end\":return _context.stop();}}},_callee);})),[]);console.log(orderdata);// deleting user\nvar deleteuser=function deleteuser(id){return fetch(\"http://localhost:5000/api/user/\".concat(id),{method:\"DELETE\",headers:{\"content-type\":\"application/json\",token:\"Bearer \".concat(token)}}).then(function(response){return response.json();}).catch(function(err){console.log(err);});};var deleteuserbtn=function deleteuserbtn(id){deleteuser(id).then(function(data){if(data.error){console.log(data);seterror(true);}else{setdeletesucess(true);}});};var showsuccess=function showsuccess(){if(deletesucess){localStorage.removeItem(\"jwt\");return/*#__PURE__*/_jsx(Redirect,{to:\"/\"});}};var showpasssuccess=function showpasssuccess(){return/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-info\",style:{display:passsuccess?'':'none'},children:\"Password updated succesfully.\"});};var showaddsuccess=function showaddsuccess(){return/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-info\",style:{display:addsuccess?'':'none'},children:\"Address updated successfully.\"});};var showerror=function showerror(){return/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-info\",style:{display:error?'':'none'},children:\"Something went wrong\"});};var showlen=function showlen(){return/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-info\",style:{display:len?'':'none'},children:\"character length should be greater than 8\"});};var updatepassword=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(user){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:return _context2.abrupt(\"return\",fetch(\"http://localhost:5000/api/user/\".concat(id),{method:\"PUT\",headers:{Accept:'application/json',\"content-type\":\"application/json\",token:\"Bearer \".concat(usertoken)},body:JSON.stringify(user)}).then(function(response){return response.json();}).catch(function(err){console.log(err);}));case 1:case\"end\":return _context2.stop();}}},_callee2);}));return function updatepassword(_x){return _ref2.apply(this,arguments);};}();var passupdate=function passupdate(event){event.preventDefault();if(newpass.length<8){setlen(true);setnewpass(\"\");}else{updatepassword({username:user.username,password:newpass}).then(function(data){if(data.error){console.log(data);seterror(true);setnewpass(\"\");}else{setpasssuccess(true);setnewpass(\"\");}});}};var addupdate=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(event){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:event.preventDefault();console.log(add);console.log(\"add\");if(add.length<8){setlen(true);setadd(\"\");}else{updatepassword({username:user.username,address:add}).then(function(data){if(data.error){console.log(data);seterror(true);setadd(\"\");}else{setaddsuccess(true);setadd(\"\");console.log(\"jwt\");var x=JSON.parse(localStorage.getItem(\"jwt\"));console.log(x.user);x.user.address=add;console.log(x);localStorage.setItem(\"jwt\",JSON.stringify(x));}});}case 4:case\"end\":return _context3.stop();}}},_callee3);}));return function addupdate(_x2){return _ref3.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(Fragment,{children:[/*#__PURE__*/_jsx(NAV,{}),showerror(),showsuccess(),showpasssuccess(),showaddsuccess(),showlen(),/*#__PURE__*/_jsx(\"div\",{style:{paddingBottom:\"150px\"},children:/*#__PURE__*/_jsx(\"div\",{className:\"container mt-5\",children:/*#__PURE__*/_jsx(\"div\",{className:\"row justify-content-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-8\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"row justify-content-evenly\",children:/*#__PURE__*/_jsxs(\"div\",{class:\"card\",style:{padding:\"0px\"},children:[/*#__PURE__*/_jsx(\"h5\",{class:\"card-header\",children:\"User details\"}),/*#__PURE__*/_jsxs(\"div\",{class:\"card-body\",children:[/*#__PURE__*/_jsxs(\"h5\",{class:\"card-title\",children:[\"Username-\",user.username]}),/*#__PURE__*/_jsxs(\"h5\",{class:\"card-title\",children:[\"Email -\",user.email]})]})]})}),/*#__PURE__*/_jsx(\"h4\",{className:\"mt-4 mb-2\",children:user.isadmin?/*#__PURE__*/_jsx(\"a\",{href:\"/admin\",children:\"go to admin page\"}):\"\"}),/*#__PURE__*/_jsx(\"div\",{className:\"container mt-3\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"row justify-content-center\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-3 mt-2\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"user-btn\",\"data-bs-toggle\":\"modal\",\"data-bs-target\":\"#Modaladdress\",children:\"Add address\"}),/*#__PURE__*/_jsx(\"div\",{className:\"modal fade\",id:\"Modaladdress\",tabindex:\"-1\",\"aria-labelledby\":\"exampleModalLabel\",\"aria-hidden\":\"true\",children:/*#__PURE__*/_jsx(\"div\",{className:\"modal-dialog\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"modal-title\",id:\"exampleModalLabel\",children:\"ADD YOUR ADDRESS\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn-close\",\"data-bs-dismiss\":\"modal\",\"aria-label\":\"Close\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"modal-body\",children:/*#__PURE__*/_jsxs(\"form\",{children:[/*#__PURE__*/_jsxs(\"div\",{class:\"form-group mt-2\",children:[/*#__PURE__*/_jsx(\"label\",{for:\"address\",className:\"mb-2\",children:\"Give complete Address \"}),/*#__PURE__*/_jsx(\"input\",{value:add,type:\"text\",onChange:function onChange(e){return setadd(e.target.value);},class:\"form-control user-inp mb-2\",id:\"address\",placeholder:\"Address\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:addupdate,\"data-bs-dismiss\":\"modal\",class:\"btn user-btn mt-2\",children:\"Submit\"})]})})]})})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-3 mt-2\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"user-btn\",\"data-bs-toggle\":\"modal\",\"data-bs-target\":\"#modalpassword\",children:\"Set new password\"}),/*#__PURE__*/_jsx(\"div\",{className:\"modal fade\",id:\"modalpassword\",tabindex:\"-1\",\"aria-labelledby\":\"exampleModalLabel\",\"aria-hidden\":\"true\",children:/*#__PURE__*/_jsx(\"div\",{className:\"modal-dialog\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"modal-title\",id:\"exampleModalLabel\",children:\"Set New Password\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn-close\",\"data-bs-dismiss\":\"modal\",\"aria-label\":\"Close\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"modal-body\",children:/*#__PURE__*/_jsxs(\"form\",{children:[/*#__PURE__*/_jsxs(\"div\",{class:\"form-group mt-2\",children:[/*#__PURE__*/_jsx(\"label\",{for:\"exampleInputPassword1\",className:\"mb-2\",children:\"Password\"}),/*#__PURE__*/_jsx(\"input\",(_jsx2={value:newpass,type:\"password\",onChange:function onChange(e){return setnewpass(e.target.value);}},_defineProperty(_jsx2,\"value\",newpass),_defineProperty(_jsx2,\"class\",\"form-control user-inp mb-2\"),_defineProperty(_jsx2,\"id\",\"exampleInputPassword1\"),_defineProperty(_jsx2,\"placeholder\",\"Password\"),_jsx2))]}),/*#__PURE__*/_jsx(\"button\",{onClick:passupdate,\"data-bs-dismiss\":\"modal\",class:\"btn user-btn mt-2\",children:\"Submit\"})]})})]})})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-3 mt-2\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"user-btn\",\"data-bs-toggle\":\"modal\",\"data-bs-target\":\"#Modaldelete\",children:\"Delete account\"}),/*#__PURE__*/_jsx(\"div\",{className:\"modal fade\",id:\"Modaldelete\",tabindex:\"-1\",\"aria-labelledby\":\"exampleModalLabel\",\"aria-hidden\":\"true\",children:/*#__PURE__*/_jsx(\"div\",{className:\"modal-dialog\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"modal-title\",id:\"exampleModalLabel\",children:\"Delete Account\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn-close\",\"data-bs-dismiss\":\"modal\",\"aria-label\":\"Close\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"modal-body\",children:\"Do you really want to delete your account\"}),/*#__PURE__*/_jsx(\"div\",{className:\"modal-footer\",children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:function onClick(){deleteuserbtn(user._id);},className:\"btn user-btn\",\"data-bs-dismiss\":\"modal\",children:\"Yes\"})})]})})})]})]})}),/*#__PURE__*/_jsx(\"h3\",{className:\"mt-5 mb-3\",children:\"your previous orders\"}),/*#__PURE__*/_jsx(\"div\",{class:\"accordion accordion-flush\",id:\"accordionFlushExample\",children:orderdata.map(function(item,index){return/*#__PURE__*/_jsxs(\"div\",{class:\"accordion-item\",children:[/*#__PURE__*/_jsx(\"h2\",{class:\"accordion-header\",id:\"flush-headingOne\",children:/*#__PURE__*/_jsxs(\"button\",{class:\"accordion-button collapsed\",type:\"button\",\"data-bs-toggle\":\"collapse\",\"data-bs-target\":\"#flush-collapseOne\",\"aria-expanded\":\"false\",\"aria-controls\":\"flush-collapseOne\",children:[\"Order \",index+1]})}),/*#__PURE__*/_jsxs(\"div\",{id:\"flush-collapseOne\",class:\"accordion-collapse collapse mt-2\",\"aria-labelledby\":\"flush-headingOne\",\"data-bs-parent\":\"#accordionFlushExample\",children:[/*#__PURE__*/_jsxs(\"h5\",{children:[\"Payment id - \",item.paymentid]}),/*#__PURE__*/_jsxs(\"h5\",{children:[\"Amount - \",item.amount]}),/*#__PURE__*/_jsxs(\"h5\",{children:[\"Address - \",item.address]}),/*#__PURE__*/_jsxs(\"h5\",{children:[\"Products -\",item.products.map(function(p){return/*#__PURE__*/_jsx(\"span\",{style:{marginLeft:\"10px\"},children:p.title});})]})]})]});})})]})})})})]});}export default DASHBOARD;","map":{"version":3,"sources":["/Users/rishabh/Desktop/E-shop/e-shop/client/src/account/dashboard.js"],"names":["React","Fragment","NAV","isauthenticated","useState","Redirect","axios","useEffect","DASHBOARD","user","token","deletesucess","setdeletesucess","addsuccess","setaddsuccess","passsuccess","setpasssuccess","orderdata","setorderdata","error","seterror","len","setlen","add","setadd","newpass","setnewpass","id","_id","usertoken","fetch","method","headers","Accept","then","response","json","catch","err","console","log","order","deleteuser","deleteuserbtn","data","showsuccess","localStorage","removeItem","showpasssuccess","display","showaddsuccess","showerror","showlen","updatepassword","body","JSON","stringify","passupdate","event","preventDefault","length","username","password","addupdate","address","x","parse","getItem","setItem","paddingBottom","padding","email","isadmin","e","target","value","map","item","index","paymentid","amount","products","p","marginLeft","title"],"mappings":"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","sourcesContent":["import React from 'react'\nimport { Fragment } from 'react'\nimport './dashboard.css'\nimport NAV from '../components/nav'\nimport { isauthenticated } from '../auth/authenticate'\nimport { useState } from 'react'\nimport { Redirect } from 'react-router-dom'\nimport axios from 'axios'\nimport { useEffect } from 'react'\n\nfunction DASHBOARD() {\n\n    const user=isauthenticated().user;\n    const token=isauthenticated().token;\n    const [deletesucess,setdeletesucess]=useState(false)\n    const [addsuccess, setaddsuccess] = useState(false)\n    const [passsuccess, setpasssuccess] = useState(false)\n    const [orderdata, setorderdata] = useState([])\n    const [error, seterror] = useState(false)\n    const [len, setlen] = useState(false)\n    const [add, setadd] = useState(\"\")\n    const [newpass, setnewpass] = useState(\"\")\n    const id=user._id\n    const usertoken=token\n  \n  \n  useEffect(async() => {\n    var order=await fetch(`http://localhost:5000/api/order/find/${id}`,{\n          method:\"GET\",\n          headers:{\n              Accept:'application/json',\n              \"content-type\":\"application/json\",\n              token:`Bearer ${usertoken}`\n          },\n      }).then(response=>{\n          return response.json();\n      }).catch(err=>{\n          console.log(err)\n      })\n   setorderdata(order)\n  }, [])\n  console.log(orderdata)\n\n\n  // deleting user\n    const deleteuser=(id)=>{\n        return fetch(`http://localhost:5000/api/user/${id}`,{\n            method:\"DELETE\",\n            headers:{\n                \"content-type\":\"application/json\",\n                token:`Bearer ${token}`\n            }\n        }).then(response=>{\n            return response.json();\n        }).catch(err=>{\n            console.log(err);\n        })\n    }\n    const deleteuserbtn=(id)=>{\n        deleteuser(id).then(data=>{\n            if(data.error)\n            {\n                console.log(data)\n                seterror(true)\n            }\n            else{\n               setdeletesucess(true)\n            }\n        })\n    }\n    const showsuccess=()=>{\n        if(deletesucess)\n        {\n            localStorage.removeItem(\"jwt\")\n            return <Redirect to=\"/\" />\n        }\n    };\n    const showpasssuccess=()=>(\n        <div className=\"alert alert-info\" style={{display:passsuccess ? '':'none'}}>\n         Password updated succesfully.\n        </div>\n   );\n  const showaddsuccess=()=>(\n    <div className=\"alert alert-info\" style={{display:addsuccess ? '':'none'}}>\n    Address updated successfully.\n    </div>\n  );\n    const showerror=()=>(\n        <div className=\"alert alert-info\" style={{display:error ? '':'none'}}>\n              Something went wrong\n         </div>\n    );\n    const showlen=()=>(\n      <div className=\"alert alert-info\" style={{display:len ? '':'none'}}>\n            character length should be greater than 8\n       </div>\n  );\n\n    const updatepassword=async(user)=>{\n      return fetch(`http://localhost:5000/api/user/${id}`,{\n          method:\"PUT\",\n          headers:{\n              Accept:'application/json',\n              \"content-type\":\"application/json\",\n              token:`Bearer ${usertoken}`\n          },\n          body:JSON.stringify(user)\n      }).then(response=>{\n          return response.json();\n      }).catch(err=>{\n          console.log(err)\n      })\n  }\n\n    const passupdate=(event)=>{\n      event.preventDefault();\n     if(newpass.length<8)\n     {\n            setlen(true)\n            setnewpass(\"\")\n     }\n     else{\n      updatepassword({username:user.username,password:newpass}).then(data=>{\n        if(data.error)\n        {\n            console.log(data)\n            seterror(true)\n            setnewpass(\"\")\n        }\n        else{\n         setpasssuccess(true)\n         setnewpass(\"\")\n        }\n           \n       })\n     }\n   }\n   const addupdate = async (event)=>{\n    event.preventDefault();\n    console.log(add)\n    console.log(\"add\")\n   if(add.length<8)\n   {\n    setlen(true)\n    setadd(\"\")\n   }\n   else{\n    updatepassword({username:user.username,address:add}).then(data=>{\n      if(data.error)\n      {\n          console.log(data)\n          seterror(true)\n          setadd(\"\")\n      }\n      else{\n          setaddsuccess(true)\n          setadd(\"\")\n         console.log(\"jwt\");\n         var x=JSON.parse(localStorage.getItem(\"jwt\"))\n         console.log(x.user)\n         x.user.address=add\n         console.log(x)\n         localStorage.setItem(\"jwt\",JSON.stringify(x));\n        \n      }\n         \n     })\n   }\n }\n    return (\n        <Fragment>\n        <NAV/>  \n            {\n                showerror()\n            }\n            {\n                showsuccess()\n            }\n            {\n              showpasssuccess()\n            }\n            {\n              showaddsuccess()\n            }\n            {\n              showlen()\n            }\n\n\n\n\n        <div style={{paddingBottom:\"150px\"}}>   \n        {/* padding for footer */}\n            <div className=\"container mt-5\">\n                <div className=\"row justify-content-center\">\n                       <div className=\"col-md-8\">\n                         <div className='row justify-content-evenly'>\n                       \n                      \n                         <div class=\"card\" style={{padding:\"0px\"}}>\n                         <h5 class=\"card-header\">User details</h5>\n                         <div class=\"card-body\">\n                           <h5 class=\"card-title\">Username-{user.username}</h5>\n                           <h5 class=\"card-title\">Email -{user.email}</h5>\n                           \n                         </div>\n                       </div>\n                   \n\n                         </div>\n\n<h4 className=\"mt-4 mb-2\">\n    { user.isadmin ? <a href=\"/admin\">go to admin page</a> :\"\"}\n</h4>\n<div className='container mt-3'>\n <div className='row justify-content-center'>\n     <div className='col-md-3 mt-2'>\n         <button className='user-btn' data-bs-toggle=\"modal\" data-bs-target=\"#Modaladdress\">Add address</button>\n             <div className=\"modal fade\" id=\"Modaladdress\" tabindex=\"-1\" aria-labelledby=\"exampleModalLabel\" aria-hidden=\"true\">\n                <div className=\"modal-dialog\">\n                    <div className=\"modal-content\">\n                         <div className=\"modal-header\">\n                              <h5 className=\"modal-title\" id=\"exampleModalLabel\">ADD YOUR ADDRESS</h5>\n                              <button type=\"button\" className=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\n                         </div>\n                         <div className=\"modal-body\">\n                         <form>\n                            <div class=\"form-group mt-2\">\n                                <label for=\"address\" className='mb-2'>Give complete Address </label>\n                               <input value={add} type=\"text\" onChange={(e) => setadd(e.target.value)} class=\"form-control user-inp mb-2\" id=\"address\" placeholder=\"Address\"/>\n                            </div>\n                            <button onClick={addupdate} data-bs-dismiss=\"modal\" class=\"btn user-btn mt-2\">Submit</button>\n                        </form>\n                      </div>\n                </div>\n              </div>\n            </div>\n     </div>\n\n     <div className='col-md-3 mt-2'>\n\n     <button className='user-btn' data-bs-toggle=\"modal\" data-bs-target=\"#modalpassword\">Set new password</button>\n     <div className=\"modal fade\" id=\"modalpassword\" tabindex=\"-1\" aria-labelledby=\"exampleModalLabel\" aria-hidden=\"true\">\n                <div className=\"modal-dialog\">\n                    <div className=\"modal-content\">\n                         <div className=\"modal-header\">\n                              <h5 className=\"modal-title\" id=\"exampleModalLabel\">Set New Password</h5>\n                              <button type=\"button\" className=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\n                         </div>\n                         <div className=\"modal-body\">\n                         <form>\n                          \n                           <div class=\"form-group mt-2\">\n                            <label for=\"exampleInputPassword1\" className='mb-2'>Password</label>\n                            <input value={newpass} type=\"password\" onChange={(e) => setnewpass(e.target.value)} value ={newpass} class=\"form-control user-inp mb-2\" id=\"exampleInputPassword1\" placeholder=\"Password\"/>\n                             </div>\n                            <button onClick={passupdate} data-bs-dismiss=\"modal\" class=\"btn user-btn mt-2\">Submit</button>\n                          </form>\n                      </div>\n                </div>\n            </div>\n            </div>\n     </div>\n     \n     <div className='col-md-3 mt-2'>\n     <button className=\"user-btn\" data-bs-toggle=\"modal\" data-bs-target=\"#Modaldelete\">\n                 Delete account\n            </button>\n            \n            <div className=\"modal fade\" id=\"Modaldelete\" tabindex=\"-1\" aria-labelledby=\"exampleModalLabel\" aria-hidden=\"true\">\n                <div className=\"modal-dialog\">\n                    <div className=\"modal-content\">\n                         <div className=\"modal-header\">\n                              <h5 className=\"modal-title\" id=\"exampleModalLabel\">Delete Account</h5>\n                              <button type=\"button\" className=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\n                         </div>\n                         <div className=\"modal-body\">\n                          Do you really want to delete your account\n                         </div>\n                     <div className=\"modal-footer\">\n                     <button type=\"button\" onClick={()=>{deleteuserbtn(user._id)}}  className=\"btn user-btn\" data-bs-dismiss=\"modal\">Yes</button>\n                     </div>\n                </div>\n            </div>\n            </div>\n     </div>\n </div>\n</div>\n<h3 className=\"mt-5 mb-3\">\n    your previous orders\n</h3>\n<div class=\"accordion accordion-flush\" id=\"accordionFlushExample\">\n\n  {\n    orderdata.map((item,index)=>(\n      <div class=\"accordion-item\">\n    <h2 class=\"accordion-header\" id=\"flush-headingOne\">\n      <button class=\"accordion-button collapsed\" type=\"button\" data-bs-toggle=\"collapse\" data-bs-target=\"#flush-collapseOne\" aria-expanded=\"false\" aria-controls=\"flush-collapseOne\">\n        Order {index+1}\n      </button>\n    </h2>\n    <div id=\"flush-collapseOne\" class=\"accordion-collapse collapse mt-2\" aria-labelledby=\"flush-headingOne\" data-bs-parent=\"#accordionFlushExample\">\n     <h5>\n       Payment id - {item.paymentid}\n     </h5>\n     <h5>\n       Amount - {item.amount}\n     </h5>\n     <h5>\n       Address - {item.address}\n     </h5>\n   <h5>\n     Products - \n     {\n\n   item.products.map(p=>(\n    <span style={{marginLeft:\"10px\"}}>\n      { p.title }\n    </span>\n  ))\n     }\n</h5>\n     \n    </div>\n  </div>\n    ))\n  }\n \n</div>\n\n                       </div>\n                </div>\n            </div>\n        </div>\n        </Fragment> \n    )\n}\n\nexport default DASHBOARD\n"]},"metadata":{},"sourceType":"module"}