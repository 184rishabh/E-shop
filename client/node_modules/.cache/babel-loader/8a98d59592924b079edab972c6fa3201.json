{"ast":null,"code":"import _defineProperty from\"/Users/rishabh/Desktop/E-shop/e-shop/client/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/Users/rishabh/Desktop/E-shop/e-shop/client/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/rishabh/Desktop/E-shop/e-shop/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from'react';import{Fragment}from'react';import'./login.css';import loginimg from'../components/static/loginimg.jpeg';import{Redirect}from'react-router';import{isauthenticated}from'../auth/authenticate';import NAV from'../components/nav';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function LOGIN(){//storing the token in local storage\nvar authenticate=function authenticate(data,next){if(typeof window!=='undefined'){localStorage.setItem('jwt',JSON.stringify(data));next();}};var _isauthenticated=isauthenticated(),user=_isauthenticated.user;//user form details\nvar _useState=useState({name:\"\",password:\"\",error:\"\",loading:false,redirectdash:false}),_useState2=_slicedToArray(_useState,2),values=_useState2[0],setvalues=_useState2[1];var name=values.name,password=values.password,loading=values.loading,error=values.error,redirectdash=values.redirectdash;var handlechange=function handlechange(name){return function(event){setvalues(_objectSpread(_objectSpread({},values),{},_defineProperty({error:false},name,event.target.value)));};};//calling signin api from backend\nvar signin=function signin(user){return fetch('http://localhost:5000/api/auth/login',{method:\"POST\",headers:{Accept:'application/json',\"content-type\":\"application/json\"},body:JSON.stringify(user)}).then(function(response){return response.json();}).catch(function(err){console.log(err);});};var clicksubmit=function clicksubmit(event){event.preventDefault();setvalues(_objectSpread(_objectSpread({},values),{},{error:false,loading:true}));console.log(values);signin({username:name,password:password}).then(function(data){if(data.error){setvalues(_objectSpread(_objectSpread({},values),{},{error:data.error,loading:false}));}else{authenticate(data,function(){setvalues(_objectSpread(_objectSpread({},values),{},{redirectdash:true}));});}});};//error message \nvar showerror=function showerror(){return/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-info\",style:{display:error?'':'none'},children:error});};//show loading\nvar showloading=function showloading(){return loading&&/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-info\",children:/*#__PURE__*/_jsx(\"h3\",{children:\"loading\"})});};//redirect after signin\nvar redirectuser=function redirectuser(){if(redirectdash){if(user&&user.isadmin){return/*#__PURE__*/_jsx(Redirect,{to:\"/admin\"});}else{return/*#__PURE__*/_jsx(Redirect,{to:\"/\"});}}};return/*#__PURE__*/_jsxs(Fragment,{children:[/*#__PURE__*/_jsx(NAV,{}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"div\",{className:\"container login-container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"row login-row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-lg-5 login-img-container\",children:/*#__PURE__*/_jsx(\"img\",{src:loginimg,alt:\"\",className:\"img-fluid login-img\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-lg-7 text-center py-5\",children:[showerror(),showloading(),redirectuser(),/*#__PURE__*/_jsx(\"h1\",{style:{color:'#f7444e'},children:\"Login\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:clicksubmit,children:[/*#__PURE__*/_jsx(\"div\",{className:\"form-row py-3 pt-5\",children:/*#__PURE__*/_jsx(\"div\",{className:\"offset-1 col-lg-10\",children:/*#__PURE__*/_jsx(\"input\",{onChange:handlechange('name'),type:\"text\",className:\"login-input\",placeholder:\"Username\",required:true})})}),/*#__PURE__*/_jsx(\"div\",{className:\"form-row\",children:/*#__PURE__*/_jsx(\"div\",{className:\"offset-1 py-3 col-lg-10\",children:/*#__PURE__*/_jsx(\"input\",{onChange:handlechange('password'),type:\"Password\",className:\"login-input\",placeholder:\"**********\",required:true})})}),/*#__PURE__*/_jsx(\"div\",{className:\"form-row py-3\",children:/*#__PURE__*/_jsx(\"div\",{className:\"offset-1 col-lg-10\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"login-btn\",children:\"LogIn\"})})})]})]})]})})})]});}export default LOGIN;","map":{"version":3,"sources":["/Users/rishabh/Desktop/E-shop/e-shop/client/src/account/login.js"],"names":["React","useState","Fragment","loginimg","Redirect","isauthenticated","NAV","LOGIN","authenticate","data","next","window","localStorage","setItem","JSON","stringify","user","name","password","error","loading","redirectdash","values","setvalues","handlechange","event","target","value","signin","fetch","method","headers","Accept","body","then","response","json","catch","err","console","log","clicksubmit","preventDefault","username","showerror","display","showloading","redirectuser","isadmin","color"],"mappings":"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","sourcesContent":["import React ,{useState}from 'react'\nimport { Fragment } from 'react'\nimport './login.css'\nimport loginimg from '../components/static/loginimg.jpeg'\nimport { Redirect } from 'react-router';\nimport { isauthenticated } from '../auth/authenticate'\nimport NAV from '../components/nav'\n\nfunction LOGIN() {\n   \n    //storing the token in local storage\n    const authenticate=(data,next)=>{\n     if(typeof window!=='undefined')\n     {\n         localStorage.setItem('jwt',JSON.stringify(data))\n         next()\n     }\n    }\n\n    const {user}=isauthenticated()\n\n    //user form details\n    const [values,setvalues]=useState(\n        {\n            name:\"\",\n            password:\"\",\n            error:\"\",\n            loading:false,\n            redirectdash:false,\n        }\n    )\n\n    const { name , password ,loading ,error ,redirectdash }=values;\n    \n    const handlechange=name=>event=>{\n    setvalues({...values,error:false,[name]:event.target.value})\n    \n    }\n\n    //calling signin api from backend\n    const signin=(user)=>{\n        return fetch('http://localhost:5000/api/auth/login',{\n            method:\"POST\",\n            headers:{\n                Accept:'application/json',\n                \"content-type\":\"application/json\"\n            },\n            body:JSON.stringify(user)\n        }).then(response=>{\n            return response.json();\n        }).catch(err=>{\n            console.log(err)\n        })\n    }\n\n    const clicksubmit=(event)=>{\n       event.preventDefault();\n       setvalues({...values ,error:false,loading:true});\n       console.log(values)\n       signin({username:name,password:password})\n       .then(data=>{\n           if(data.error)\n           {\n              setvalues({...values,error:data.error,loading:false})\n              \n           }\n           else\n           {\n               authenticate(\n                   data,()=>{\n                    setvalues({...values,\n                        redirectdash:true\n                      })\n                   }\n               )\n           }\n\n       })\n    }\n\n    //error message \n    const showerror=()=>(\n        <div className=\"alert alert-info\" style={{display:error ? '':'none'}}>\n              {error}\n         </div>\n    );\n\n    //show loading\n    const showloading=()=>(\n        loading && (<div className=\"alert alert-info\">\n               <h3>loading</h3>\n        </div>)\n    );\n\n    //redirect after signin\n    const redirectuser=()=>{\n        if(redirectdash)\n        {\n            if(user && user.isadmin)\n            {\n                return <Redirect to=\"/admin\" />\n            }\n            else{\n                \n                return <Redirect to=\"/\" />\n            }\n        }\n    }\n\n    return (\n        <Fragment>\n            <NAV/>\n            <div>\n                <div className=\"container login-container\">\n                    <div className=\"row login-row\">\n\n                        {/* login image */}\n\n                        <div className=\"col-lg-5 login-img-container\">\n                            <img src={loginimg} alt=\"\" className=\"img-fluid login-img\"/>\n                        </div>\n\n                         {/* Login form */}\n                         \n                        <div className=\"col-lg-7 text-center py-5\">\n                           {\n                            showerror()\n                           }             \n                           {\n                            showloading()\n                           }\n                           {\n                            redirectuser()\n                           } \n                            <h1 style={{color:'#f7444e'}}>\n                                 Login\n                            </h1>  \n                                <form onSubmit={clicksubmit}>\n\n                                    <div className=\"form-row py-3 pt-5\">\n                                        <div className=\"offset-1 col-lg-10\">\n                                            <input onChange={handlechange('name')} type=\"text\" className=\"login-input\" placeholder=\"Username\" required />\n                                        </div> \n                                    </div>\n\n                                    <div className=\"form-row\">\n                                        <div className=\"offset-1 py-3 col-lg-10\">\n                                            <input onChange={handlechange('password')} type=\"Password\" className=\"login-input\" placeholder=\"**********\" required/>\n                                        </div>\n                                    </div>\n\n                                    <div className=\"form-row py-3\">\n                                        <div className=\"offset-1 col-lg-10\">\n                                            <button type=\"submit\" className=\"login-btn\">LogIn</button>\n                                        </div>\n                                    </div>\n                                </form>\n                        </div>\n                    </div>\n                </div>           \n            </div>\n        </Fragment>\n    )\n}\n\nexport default LOGIN\n"]},"metadata":{},"sourceType":"module"}