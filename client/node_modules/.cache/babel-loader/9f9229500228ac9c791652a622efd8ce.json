{"ast":null,"code":"import _regeneratorRuntime from\"/Users/rishabh/Desktop/E-shop/e-shop/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/rishabh/Desktop/E-shop/e-shop/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/rishabh/Desktop/E-shop/e-shop/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{Fragment}from'react';import'./cart.css';import{useState}from'react';import{useEffect}from'react';import NAV from'../components/nav';import axios from'axios';import{isauthenticated}from'../auth/authenticate';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function CART(){var iconstyle={fontSize:\"20px\",margin:\"5px\"};var _useState=useState([]),_useState2=_slicedToArray(_useState,2),cartproduct=_useState2[0],setcartproduct=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),cartnos=_useState4[0],setcartnos=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),success=_useState6[0],setsuccess=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),address=_useState8[0],setaddress=_useState8[1];useEffect(function(){setcartnos(false);var fetchdata=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var cart;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:cart=[];if(localStorage.getItem('products')){cart=JSON.parse(localStorage.getItem('products'));}setcartproduct(cart);case 3:case\"end\":return _context.stop();}}},_callee);}));return function fetchdata(){return _ref.apply(this,arguments);};}();fetchdata();},[cartnos]);function plusquantity(id){var carts=[];if(typeof window!==\"undefined\")if(localStorage.getItem(\"products\")){carts=JSON.parse(localStorage.getItem(\"products\"));}console.log(carts);carts.map(function(product,i){if(product.productId===id){if(carts[i].quantity>=5){carts[i].quantity=5;}else{carts[i].quantity+=1;}setcartnos(true);}});localStorage.setItem(\"products\",JSON.stringify(carts));}var removeItem=function removeItem(productId){var cart=[];console.log(\"in\");if(typeof window!=='undefined'){if(localStorage.getItem('products')){cart=JSON.parse(localStorage.getItem('products'));}cart.map(function(product,i){if(product.productId===productId){cart.splice(i,1);console.log(product);}});localStorage.setItem('products',JSON.stringify(cart));}setcartnos(true);return cart;};var emptyCart=function emptyCart(){if(typeof window!=='undefined'){localStorage.removeItem('products');setcartnos(true);}};function minusquantity(id){var carts=[];if(typeof window!==\"undefined\")if(localStorage.getItem(\"products\")){carts=JSON.parse(localStorage.getItem(\"products\"));}console.log(carts);carts.map(function(product,i){if(product.productId===id){if(carts[i].quantity==1){carts[i].quantity=1;}else{carts[i].quantity-=1;}setcartnos(true);}});localStorage.setItem(\"products\",JSON.stringify(carts));}function totalquantity(id){var carts=[];var total=0;if(typeof window!==\"undefined\")if(localStorage.getItem(\"products\")){carts=JSON.parse(localStorage.getItem(\"products\"));}carts.map(function(product,i){total+=carts[i].quantity*carts[i].price;});return total;}function loadScript(src){return new Promise(function(resolve){var script=document.createElement('script');script.src=src;script.onload=function(){resolve(true);};script.onerror=function(){resolve(false);};document.body.appendChild(script);});}var userid=\"\";var add=\"\";if(isauthenticated()){userid=isauthenticated().user._id;add=isauthenticated().user.address;}var totalamount=totalquantity();console.log(\"userid\");console.log(userid);console.log(totalamount);console.log(add);var product=JSON.parse(localStorage.getItem(\"products\"));console.log(product);function displayRazorpay(){return _displayRazorpay.apply(this,arguments);}function _displayRazorpay(){_displayRazorpay=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var res,data,options,paymentObject;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:console.log(isauthenticated());if(!(isauthenticated()&&isauthenticated().user.address)){_context3.next=16;break;}_context3.next=4;return loadScript('https://checkout.razorpay.com/v1/checkout.js');case 4:res=_context3.sent;if(res){_context3.next=8;break;}alert('Razorpay SDK failed to load. Are you online?');return _context3.abrupt(\"return\");case 8:_context3.next=10;return axios.post('http://localhost:5000/api/order/razorpay',{amount:totalquantity()});case 10:data=_context3.sent;options={key:'rzp_test_vBmwkeZA0bm004',currency:'INR',amount:data.data.amount,order_id:data.data.id,name:'E-shop',description:'Thanks for shopping with us',image:'',handler:function(){var _handler=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(response){var result;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios.post('http://localhost:5000/api/order/pay-order',{razorpayPaymentId:response.razorpay_payment_id,razorpayOrderId:response.razorpay_order_id,razorpaySignature:response.razorpay_signature,userid:userid,products:product,amount:totalamount,address:add});case 2:result=_context2.sent;alert(result.data.msg);case 4:case\"end\":return _context2.stop();}}},_callee2);}));function handler(_x){return _handler.apply(this,arguments);}return handler;}(),prefill:{name:'',email:'',phone_number:''},theme:{color:\"#f7444e\"}};paymentObject=new window.Razorpay(options);paymentObject.open();_context3.next=17;break;case 16:if(!isauthenticated()){setsuccess(true);}else{setaddress(true);}case 17:case\"end\":return _context3.stop();}}},_callee3);}));return _displayRazorpay.apply(this,arguments);}var showsuccess=function showsuccess(){return/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-danger\",style:{display:success?'':'none'},children:\"Login to contiue shopping\"});};var showaddress=function showaddress(){return/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-danger\",style:{display:address?'':'none'},children:\"Add Address in your profile checkout\"});};return/*#__PURE__*/_jsxs(Fragment,{children:[/*#__PURE__*/_jsx(NAV,{}),/*#__PURE__*/_jsx(\"div\",{children:cartproduct.length>0?/*#__PURE__*/_jsxs(\"div\",{class:\"container\",children:[showsuccess(),showaddress(),/*#__PURE__*/_jsxs(\"table\",{id:\"cart\",class:\"table table-hover table-condensed\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{style:{width:\"50%\"},children:\"Product\"}),/*#__PURE__*/_jsx(\"th\",{style:{width:\"10%\"},children:\"Price\"}),/*#__PURE__*/_jsx(\"th\",{style:{width:\"8%\"},children:\"Quantity\"}),/*#__PURE__*/_jsx(\"th\",{style:{width:\"22%\"},class:\"text-center\",children:\"Subtotal\"}),/*#__PURE__*/_jsx(\"th\",{style:{width:\"10%\"}})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:cartproduct.map(function(item){return/*#__PURE__*/_jsx(Fragment,{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{\"data-th\":\"Product\",children:/*#__PURE__*/_jsxs(\"div\",{class:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{class:\"col-sm-2 hidden-xs\",children:/*#__PURE__*/_jsx(\"img\",{src:item.image,alt:\"...\",class:\"img-responsive\"})}),/*#__PURE__*/_jsx(\"div\",{class:\"col-sm-10\",children:/*#__PURE__*/_jsx(\"h4\",{class:\"nomargin\",children:item.title})})]})}),/*#__PURE__*/_jsx(\"td\",{\"data-th\":\"Price\",children:item.price}),/*#__PURE__*/_jsxs(\"td\",{\"data-th\":\"Quantity\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return plusquantity(item.productId);},class:\"plus-btn\",type:\"button\",name:\"button\",children:/*#__PURE__*/_jsx(\"img\",{src:\"https://designmodo.com/demo/shopping-cart/plus.svg\",alt:\"\"})}),/*#__PURE__*/_jsx(\"span\",{className:\"item-quantity\",children:item.quantity}),/*#__PURE__*/_jsx(\"button\",{class:\"minus-btn\",onClick:function onClick(){return minusquantity(item.productId);},type:\"button\",name:\"button\",children:/*#__PURE__*/_jsx(\"img\",{src:\"https://designmodo.com/demo/shopping-cart/minus.svg\",alt:\"\"})})]}),/*#__PURE__*/_jsx(\"td\",{\"data-th\":\"Subtotal\",class:\"text-center\",children:item.quantity*item.price}),/*#__PURE__*/_jsx(\"td\",{class:\"actions\",\"data-th\":\"\",children:/*#__PURE__*/_jsx(\"button\",{className:\"trash-btn\",onClick:function onClick(){removeItem(item.productId);},children:/*#__PURE__*/_jsx(\"i\",{class:\"fa fa-trash\"})})})]})});})}),/*#__PURE__*/_jsx(\"tfoot\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsxs(\"td\",{children:[/*#__PURE__*/_jsx(\"button\",{onClick:emptyCart,class:\"btn btn-checkout mt-2 mb-2\",children:\"Clear Cart\"}),\" \",/*#__PURE__*/_jsxs(\"a\",{href:\"/products\",class:\"btn btn-checkout\",children:[\" \",/*#__PURE__*/_jsx(\"i\",{class:\"fa fa-angle-left\"}),\" Continue Shopping\"]})]}),/*#__PURE__*/_jsx(\"td\",{colspan:\"2\",class:\"hidden-xs\"}),/*#__PURE__*/_jsx(\"td\",{class:\"hidden-xs text-center\",children:/*#__PURE__*/_jsxs(\"strong\",{children:[\"Total \",totalquantity()]})}),/*#__PURE__*/_jsxs(\"td\",{children:[\" \",/*#__PURE__*/_jsx(\"button\",{onClick:displayRazorpay,class:\"btn btn-checkout btn-block\",children:\"Checkout\"}),\" \"]})]})})]})]}):/*#__PURE__*/_jsx(\"div\",{className:\"mt-5 mb-5\",children:/*#__PURE__*/_jsx(\"div\",{className:\"container mt-5\",style:{paddingBottom:\"10%\",paddingTop:\"10%\"},children:/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Your Cart is empty add.\"}),/*#__PURE__*/_jsx(\"h1\",{children:\"Go shop to Add some products\"}),/*#__PURE__*/_jsx(\"a\",{href:\"/products\",children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-danger mt-3 mb-3\",children:\"Go to shop\"})})]})})})})]});}export default CART;","map":{"version":3,"sources":["/Users/rishabh/Desktop/E-shop/e-shop/client/src/cart/cartpage.js"],"names":["React","Fragment","useState","useEffect","NAV","axios","isauthenticated","CART","iconstyle","fontSize","margin","cartproduct","setcartproduct","cartnos","setcartnos","success","setsuccess","address","setaddress","fetchdata","cart","localStorage","getItem","JSON","parse","plusquantity","id","carts","window","console","log","map","product","i","productId","quantity","setItem","stringify","removeItem","splice","emptyCart","minusquantity","totalquantity","total","price","loadScript","src","Promise","resolve","script","document","createElement","onload","onerror","body","appendChild","userid","add","user","_id","totalamount","displayRazorpay","res","alert","post","amount","data","options","key","currency","order_id","name","description","image","handler","response","razorpayPaymentId","razorpay_payment_id","razorpayOrderId","razorpay_order_id","razorpaySignature","razorpay_signature","products","result","msg","prefill","email","phone_number","theme","color","paymentObject","Razorpay","open","showsuccess","display","showaddress","length","width","item","title","paddingBottom","paddingTop"],"mappings":"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","sourcesContent":["import React, { Fragment } from 'react'\nimport './cart.css'\nimport {useState} from 'react'\nimport { useEffect } from 'react'\nimport NAV from '../components/nav'\nimport axios from 'axios'\nimport { isauthenticated } from '../auth/authenticate'\n\n\nfunction CART() {\n    \n    const iconstyle={\n        fontSize:\"20px\",\n        margin:\"5px\",\n\n    }\n    const [cartproduct, setcartproduct] = useState([]);\n    const [cartnos, setcartnos] = useState(false)\n    const [success,setsuccess]=useState(false)\n    const [address, setaddress] = useState(false)\n   \n    useEffect(() => {\n        setcartnos(false)\n               const fetchdata=async()=>{\n                let cart=[]\n                if(localStorage.getItem('products')){\n                cart = JSON.parse(localStorage.getItem('products'));\n                  }\n                setcartproduct(cart);}\n            fetchdata()\n            },[cartnos])\n    \n    function plusquantity(id){\n        let carts=[];\n        if(typeof window!==\"undefined\")\n           if(localStorage.getItem(\"products\"))\n           {\n               carts=JSON.parse(localStorage.getItem(\"products\"));\n           }\n           console.log(carts)\n           carts.map((product,i)=>{\n               if(product.productId === id)\n               {\n                if(carts[i].quantity >= 5)\n                {\n                    carts[i].quantity=5;\n                }\n                else{\n                    carts[i].quantity+=1;\n                }\n                setcartnos(true);\n               }\n           });\n          localStorage.setItem(\"products\",JSON.stringify(carts));\n\n    }\n    const removeItem = productId => {\n     let cart = [];\n     console.log(\"in\")\n     if (typeof window !== 'undefined') {\n         if (localStorage.getItem('products')) {\n             cart = JSON.parse(localStorage.getItem('products'));\n         }\n \n         cart.map((product, i) => {\n             if (product.productId === productId) {\n                 cart.splice(i, 1);\n                 console.log(product)\n             }\n         });\n \n         localStorage.setItem('products', JSON.stringify(cart));\n     }\n     setcartnos(true);\n     return cart;\n };\n\n const emptyCart = () => {\n     if (typeof window !== 'undefined') {\n \n         localStorage.removeItem('products');\n         setcartnos(true)\n     }\n };\n\n\n    function minusquantity(id){\n        let carts=[];\n       \n        if(typeof window!==\"undefined\")\n           if(localStorage.getItem(\"products\"))\n           {\n               carts=JSON.parse(localStorage.getItem(\"products\"));\n           }\n           console.log(carts)\n           carts.map((product,i)=>{\n               if(product.productId === id)\n               {\n                    if(carts[i].quantity == 1)\n                    {\n                        carts[i].quantity=1;\n                    }\n                    else{\n                        carts[i].quantity-=1;\n                    }\n                    setcartnos(true);\n               }\n           });\n          localStorage.setItem(\"products\",JSON.stringify(carts));\n\n    }\n \n    function totalquantity(id){\n     let carts=[];\n     var total=0;\n     if(typeof window!==\"undefined\")\n        if(localStorage.getItem(\"products\"))\n        {\n            carts=JSON.parse(localStorage.getItem(\"products\"));\n        }\n        carts.map((product,i)=>{\n            total+=carts[i].quantity*carts[i].price\n        });\n       return total\n }\n function loadScript(src) {\n\treturn new Promise((resolve) => {\n\t\tconst script = document.createElement('script')\n\t\tscript.src = src\n\t\tscript.onload = () => {\n\t\t\tresolve(true)\n\t\t}\n\t\tscript.onerror = () => {\n\t\t\tresolve(false)\n\t\t}\n\t\tdocument.body.appendChild(script)\n\t})\n}\nvar userid=\"\";\nvar add=\"\";\n if(isauthenticated())\n {\n     userid=isauthenticated().user._id;\n     add=isauthenticated().user.address;\n }\n const totalamount=totalquantity()\n console.log(\"userid\")\n console.log(userid)\n console.log(totalamount)\n console.log(add)\n const product=JSON.parse(localStorage.getItem(\"products\")) \n console.log(product)\n\n\n\n\n\nasync function displayRazorpay() {\n    \n    console.log(isauthenticated())\n    \n    if(isauthenticated()&&isauthenticated().user.address)\n    {\n        const res = await loadScript('https://checkout.razorpay.com/v1/checkout.js')\n\n    if (!res) {\n        alert('Razorpay SDK failed to load. Are you online?')\n        return\n    }\n\n    \n    const data = await axios.post('http://localhost:5000/api/order/razorpay', {\n        amount:totalquantity()\n      });\n    \n\n\n    const options = {\n        key: 'rzp_test_vBmwkeZA0bm004',\n        currency: 'INR',\n        amount: data.data.amount,\n        order_id: data.data.id,\n        name: 'E-shop',\n        description: 'Thanks for shopping with us',\n        image: '',\n        handler: async function (response) {\n            const result = await axios.post('http://localhost:5000/api/order/pay-order', {\n              razorpayPaymentId: response.razorpay_payment_id,\n              razorpayOrderId: response.razorpay_order_id,\n              razorpaySignature: response.razorpay_signature,\n              userid:userid,\n              products:product,\n              amount:totalamount,\n              address:add\n              \n            });\n            alert(result.data.msg);\n          }, \n        prefill: {\n            name:'',\n            email: '',\n            phone_number: '',\n        },\n        theme: {\n            color: \"#f7444e\"\n        }\n    }\n    const paymentObject = new window.Razorpay(options)\n    paymentObject.open()\n    }\n    else if(!isauthenticated())\n    {\n        setsuccess(true);\n    }\n    else{\n      setaddress(true);\n    }\n}\nconst showsuccess=()=>(\n    <div className=\"alert alert-danger\" style={{display:success ? '':'none'}}>\n          Login to contiue shopping\n     </div>\n);\nconst showaddress=()=>(\n    <div className=\"alert alert-danger\" style={{display: address? '':'none'}}>\n          Add Address in your profile checkout\n     </div>\n);\n\n    return (\n       <Fragment>\n           <NAV></NAV>\n       <div>\n\n               {\n                   cartproduct.length>0?  \n                   <div class=\"container\">\n                        {\n                showsuccess()\n            }\n            {\n                showaddress()\n            }\n          <table id=\"cart\" class=\"table table-hover table-condensed\">\n            <thead>\n              <tr>\n              <th style={{width:\"50%\"}}>Product</th>\n                <th style={{width:\"10%\"}}>Price</th>\n                <th style={{width:\"8%\"}}>Quantity</th>\n                <th style={{width:\"22%\"}} class=\"text-center\">Subtotal</th>\n                <th style={{width:\"10%\"}}></th>\n              </tr>\n            </thead>\n            <tbody>\n        \n            {cartproduct.map(item=>(\n                <Fragment>\n              <tr>\n                <td data-th=\"Product\">\n                  <div class=\"row\">\n                    <div class=\"col-sm-2 hidden-xs\"><img src={item.image} alt=\"...\" class=\"img-responsive\" /></div>\n                    <div class=\"col-sm-10\">\n                      <h4 class=\"nomargin\">{item.title}</h4>\n                    </div>\n                  </div>\n                </td>\n                <td data-th=\"Price\">{item.price}</td>\n                <td data-th=\"Quantity\">\n        \n                  <button onClick={()=>plusquantity(item.productId)} class=\"plus-btn\" type=\"button\" name=\"button\">\n                    <img src=\"https://designmodo.com/demo/shopping-cart/plus.svg\" alt=\"\" />\n                  </button>\n        \n                  <span className=\"item-quantity\">{item.quantity}</span>\n        \n                  <button class=\"minus-btn\" onClick={()=>minusquantity(item.productId)} type=\"button\" name=\"button\">\n                    <img src=\"https://designmodo.com/demo/shopping-cart/minus.svg\" alt=\"\" />\n                  </button>\n        \n                </td>\n                <td data-th=\"Subtotal\" class=\"text-center\">{item.quantity*item.price}</td>\n                <td class=\"actions\" data-th=\"\">\n                <button className=\"trash-btn\" onClick={()=>{removeItem(item.productId)}}>\n                                     <i class=\"fa fa-trash\"></i>\n                                     </button>\n                </td>\n              </tr>\n              </Fragment>\n                            ))  }\n        \n            </tbody>\n            <tfoot>\n              \n              <tr>\n                <td><button onClick={emptyCart} class=\"btn btn-checkout mt-2 mb-2\">Clear Cart</button> <a href=\"/products\" class=\"btn btn-checkout\"> <i class=\"fa fa-angle-left\"></i> Continue Shopping</a></td>\n                <td colspan=\"2\" class=\"hidden-xs\"></td>\n                <td class=\"hidden-xs text-center\"><strong>Total {totalquantity()}</strong></td>\n                <td> <button onClick={displayRazorpay} class=\"btn btn-checkout btn-block\">Checkout</button> </td>\n              </tr>\n            </tfoot>\n          </table>\n        </div>\n\n        :\n\n        <div className=\"mt-5 mb-5\" >\n            <div className=\"container mt-5\" style={{paddingBottom:\"10%\",paddingTop:\"10%\"}}>  \n           \n                <div className=\"row\">\n                    <h1>\n                        Your Cart is empty add. \n                    </h1>\n                    <h1>\n                        Go shop to Add some products\n                    </h1>\n                    <a href='/products'>\n                    <button className='btn btn-danger mt-3 mb-3'>\n                        Go to shop\n                    </button>\n                    </a>\n                </div>\n            </div>    \n            \n        </div>      \n    }\n </div>\n\n         \n\n\n\n\n           \n        {/*  \n           <div>\n        <div class=\"container padding-bottom-3x mb-1\">\n    \n        <div class=\"table-responsive shopping-cart\">\n            <table class=\"table\">\n                <thead>\n                    <tr>\n                        <th>Product</th>\n                        <th class=\"text-center\">Quantity</th>\n                        <th class=\"text-center\">Subtotal</th>\n                        <th class=\"text-center\"><button onClick={()=>{emptyCart()}}>Clear Cart</button></th>\n                     </tr>\n                </thead>\n                <tbody>\n                {cartproduct.map(item=>(\n                     <Fragment>\n                    <tr>\n                        <td>\n                            <div class=\"product-item\">\n                                <a class=\"product-thumb\" href=\"#\"><img src={item.image} alt=\"Product\"/></a>\n                                <div class=\"product-info\">\n                                    <h4 class=\"product-title\"><a href=\"#\">{item.title}</a></h4><span><em>Size:</em> 10.5</span><span><em>Color:</em> Dark Blue</span>\n                                </div>\n                            </div>\n                        </td>\n                        <td class=\"text-center\">\n                            <div class=\"count-input\">\n                            <div class=\"col\"> \n                             <button onClick={()=>minusquantity(item.productId)}><i class=\"fas fa-minus-circle\" style={iconstyle}></i></button> \n                             {item.quantity}\n                            <button onClick={()=>plusquantity(item.productId)}><i class=\"fas fa-plus-circle\" style={iconstyle}></i></button>\n                             </div>\n                            </div>\n                        </td>\n                        <td class=\"text-center text-lg text-medium\">{item.quantity*item.price}</td>\n                        \n                        <td class=\"text-center\"><a class=\"remove-from-cart\" href=\"#\" data-toggle=\"tooltip\" title=\"\" data-original-title=\"Remove item\">\n                             <button onClick={()=>{removeItem(item.productId)}}>\n                             <i class=\"fa fa-trash\"></i>\n                             </button>\n                             </a></td>\n                    </tr>\n                   \n                    </Fragment>\n                    ))  }\n                </tbody>\n            </table>\n\n            <table class=\"table\">\n                <thead>\n                    <tr>\n                        <th class=\"text-center\">CART SUMMARY</th>\n                        <th class=\"text-center\">CHECKOUT {totalquantity()}</th>\n                     </tr>\n                </thead>\n            </table>\n        </div>\n    </div>\n   \n        </div>\n           */}\n       </Fragment>\n    )\n}\n\nexport default CART\n"]},"metadata":{},"sourceType":"module"}